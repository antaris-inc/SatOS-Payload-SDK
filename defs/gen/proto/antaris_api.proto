////////////////////////////////////////////////////////////
//
//  

//  Copyright 2022 Antaris, Inc.

//  

//  Licensed under the Apache License, Version 2.0 (the 'License');

//  you may not use this file except in compliance with the License.

//  You may obtain a copy of the License at

//  

//  http://www.apache.org/licenses/LICENSE-2.0

//  

//  Unless required by applicable law or agreed to in writing, software

//  distributed under the License is distributed on an 'AS IS' BASIS,

//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

//  See the License for the specific language governing permissions and

//  limitations under the License.

//  

//  Copyright: Copyright 2022 Antaris, Inc.

//  This is an autogenerated file. Any changes made to this file would likely be over-written at build time.

//  Generated-From: antaris_api.xml

//
////////////////////////////////////////////////////////////



syntax = "proto3";


package antaris_api_peer_to_peer;

enum AntarisReturnCode {
    An_SUCCESS                       = 0; // Success
    An_GENERIC_FAILURE               = -1; // Generic failure
    An_NOT_IMPLEMENTED               = -2; // Feature/interface not implemented
    An_OUT_OF_RESOURCES              = -3; // Not enough resources
    An_NOT_PERMITTED                 = -4; // Operation not allowed
    An_INVALID_PARAMS                = -5; // Invalid parameter
    An_INCOMPATIBLE_VERSION          = -6; // Incompatible version of SDK invocation
}

message AntarisSdkVersion {
    int32                           major            = 1; // major revision number
    int32                           minor            = 2; // minor revision number
    int32                           patch            = 3; // patch number
}

message ReqRegisterParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           health_check_fail_action = 2; // Action to be taken by PC on application health check failure
    AntarisSdkVersion               sdk_version      = 3; // SDK version against used by client
}

message RespRegisterParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           req_status       = 2; // status of registration request
    string                          auth_token       = 3; // auth-token to be used in case secure communication had been requested for while registering
}

message ReqGetCurrentLocationParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
}

message RespGetCurrentLocationParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           req_status       = 2; // status of get-location request
    double                          latitude         = 3; // current latitude
    double                          longitude        = 4; // current longitude
    double                          altitude         = 5; // current altitude
    float                           sd_latitude      = 6; // standard deviation in latitude
    float                           sd_longitude     = 7; // standard deviation in longitude
    float                           sd_altitude      = 8; // standard deviation in altitude
    int64                           determined_at    = 9; // time (seconds since epoch) when the location was determined
}

message ReqStageFileDownloadParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    string                          file_path        = 2; // File path relative to outbound mount-point
}

message RespStageFileDownloadParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           req_status       = 2; // status of stage file-download request
}

message ReqPayloadPowerControlParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           power_operation  = 2; // Power operation : Power-Off (0), Power-On (1)
}

message RespPayloadPowerControlParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           req_status       = 2; // status of payload-power-control request
}

message RespShutdownParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           req_status       = 2; // status of payload application shutdown request
}

message RespHealthCheckParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           application_state = 2; // Application State : Good (0), Error (non-Zero)
    int32                           reqs_to_pc_in_err_cnt = 3; // Number of requests to PC that faced error
    int32                           resps_to_pc_in_err_cnt = 4; // Number of responses to PC that faced error
}

message StartSequenceParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    string                          sequence_id      = 2; // app-defined sequence-id for payload application to execute
    string                          sequence_params  = 3; // app-defined sequence parameters corresponding to the sequence-id
    int64                           scheduled_deadline = 4; // Epoch time till this sequence is allowed to run
}

message ShutdownParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           grace_time       = 2; // grace time in seconds after which the VM will be powered down
}

message HealthCheckParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int32                           application_state = 2; // Application State : Good (0), Error (non-Zero)
    int32                           reqs_to_pc_in_err_cnt = 3; // Number of requests to PC that faced error
    int32                           resps_to_pc_in_err_cnt = 4; // Number of responses to PC that faced error
}

message PayloadMetricsInfo {
    int32                           counter          = 1; // Counter number
    string                          names            = 2; // Counter names, string
}

message ReqPayloadMetricsParams {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
}

message PayloadMetricsResponse {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
    int64                           timestamp        = 2; // Capture time stamp
    int32                           used_counter     = 3; // Counters used out of maximum 32 counters
    repeated PayloadMetricsInfo     metrics          = 4; // Counter values, maximum 32 counters
}

message CmdSequenceDoneParams {
    string                          sequence_id      = 1; // sequence id that has completed execution. MUST agree with StartSequenceParams.sequence-id.
}

message AntarisCorrelationId {
    int32                           correlation_id   = 1; // correlation id for matching requests with responses and callbacks
}

message AntarisReturnType {
    AntarisReturnCode               return_code      = 1; // return code
}

service AntarisapiApplicationCallback {
    rpc PA_StartSequence(StartSequenceParams) returns (AntarisReturnType) {}
    rpc PA_ShutdownApp(ShutdownParams) returns (AntarisReturnType) {}
    rpc PA_ProcessHealthCheck(HealthCheckParams) returns (AntarisReturnType) {}
    rpc PA_ProcessResponseRegister(RespRegisterParams) returns (AntarisReturnType) {}
    rpc PA_ProcessResponseGetCurrentLocation(RespGetCurrentLocationParams) returns (AntarisReturnType) {}
    rpc PA_ProcessResponseStageFileDownload(RespStageFileDownloadParams) returns (AntarisReturnType) {}
    rpc PA_ProcessResponsePayloadPowerControl(RespPayloadPowerControlParams) returns (AntarisReturnType) {}
    rpc PA_ProcessReqPayloadMetrics(ReqPayloadMetricsParams) returns (AntarisReturnType) {}
}

service AntarisapiPayloadController {
    rpc PC_register(ReqRegisterParams) returns (AntarisReturnType) {}
    rpc PC_get_current_location(ReqGetCurrentLocationParams) returns (AntarisReturnType) {}
    rpc PC_stage_file_download(ReqStageFileDownloadParams) returns (AntarisReturnType) {}
    rpc PC_sequence_done(CmdSequenceDoneParams) returns (AntarisReturnType) {}
    rpc PC_payload_power_control(ReqPayloadPowerControlParams) returns (AntarisReturnType) {}
    rpc PC_response_health_check(RespHealthCheckParams) returns (AntarisReturnType) {}
    rpc PC_response_shutdown(RespShutdownParams) returns (AntarisReturnType) {}
    rpc PC_response_payload_metrics(PayloadMetricsResponse) returns (AntarisReturnType) {}
}

